<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UTM Content Generator</title>
</head>
<body>

<div>
    <h1>UTM Content Generator</h1>

    <!-- Form untuk input data -->
    <form id="utmForm">
        <label for="description">Description / Projects:</label>
        <select id="description" name="description">
            <option value="Ecatalog Article">Ecatalog Article</option>
        </select><br>

        <label for="source">Source:</label>
        <select id="source" name="source">
            <option value="ecatalog">ecatalog</option>
        </select><br>

        <label for="medium">Medium:</label>
        <select id="medium" name="medium">
            <option value="ecatalogOrganic">ecatalogOrganic</option>
        </select><br>

        <label for="campaign">Campaign:</label>
        <select id="campaign" name="campaign">
            <option value="ecatalog_articleint">ecatalog_articleint</option>
        </select><br>

        <label for="year">Year:</label>
        <select id="year" name="year">
            <option value="2024">2024</option>
        </select><br>

        <label for="month">Month:</label>
        <select id="month" name="month">
            <option value="11">11</option>
            <option value="12">12</option>
        </select><br>

        <label for="code">Code:</label>
        <select id="code" name="code">
            <option value="int">int</option>
        </select><br>

        <label for="number">Numbering:</label>
        <select id="number" name="number">
            <script>
                for (let i = 1; i <= 499; i++) {
                    const formattedNumber = String(i).padStart(3, '0');
                    document.write(`<option value="${formattedNumber}">${formattedNumber}</option>`);
                }
            </script>
        </select><br>

        <label for="project">Project Code (if applicable):</label>
        <input type="text" id="project" oninput="toggleClusterField()"><br>

        <label for="cluster">Cluster (if applicable):</label>
        <input type="text" id="cluster" disabled><br>

        <label for="url">URL:</label>
        <input type="url" id="url" required><br>

        <button type="button" onclick="generateTaggedUrl()">Generate Tagged URL</button>
    </form>

    <div id="resultContainer" style="display: none;">
        <h2>Generated UTM Content and Tagged URL</h2>
        <div>
            <strong>Content:</strong>
            <div id="generatedContent"></div>
            <button onclick="copyToClipboard('generatedContent')">Copy</button>
            <span id="contentLengthIndicator"></span>
        </div>
        <div>
            <strong>Tagged URL:</strong>
            <div id="generatedTaggedUrl"></div>
            <button onclick="copyToClipboard('generatedTaggedUrl')">Copy</button>
        </div>
        <p id="warningMessage"></p>
    </div>

    <!-- Tabel Riwayat Input -->
    <table id="historyTable" style="display: none; width: 100%; border-collapse: collapse; margin-top: 20px;">
        <thead>
            <tr>
                <th>Description / Projects</th>
                <th>Source</th>
                <th>Medium</th>
                <th>Campaign</th>
                <th>Content</th>
                <th>URL</th>
                <th>Tagged URL</th>
            </tr>
        </thead>
        <tbody>
        </tbody>
    </table>
</div>

<script>
    const projectShortcodes = {
        "aerium": "aer",
        "akasa pure living": "apl",
        "bsd commercial": "bcm",
        "grand city balikpapan": "gcb",
        "klaska residence": "klr",
        "kota deltamas": "kdt",
        "kota wisata": "kws",
        "legenda wisata": "lws",
        "bsd residential": "brs",
        "southgate": "sou",
        "banjar wijaya": "bwy",
        "taman permata buana": "tpb",
        "the elements": "tel",
        "nuvasa bay": "nby",
        "the zora": "tzr",
        "upper west": "uws",
        "wisata bukit mas": "wbm",
        "hiera": "hie",
        "bsd city": "bct",
        "onesmile": "ons"
    };

    function toggleClusterField() {
        const projectField = document.getElementById("project").value.trim();
        const clusterField = document.getElementById("cluster");
        clusterField.disabled = projectField === "";
    }

    function generateTaggedUrl() {
        const description = document.getElementById("description").value;
        const source = document.getElementById("source").value;
        const medium = document.getElementById("medium").value;
        const campaign = document.getElementById("campaign").value;
        const year = document.getElementById("year").value;
        const month = document.getElementById("month").value;
        const code = document.getElementById("code").value;
        const number = document.getElementById("number").value;
        let project = document.getElementById("project").value.toLowerCase();
        const cluster = document.getElementById("cluster").value;
        const url = document.getElementById("url").value;

        if (projectShortcodes[project]) {
            project = projectShortcodes[project];
        }

        let content = `${year}_${month}_${code}_${number}`;
        if (project) content += `_${project}`;
        if (cluster) content += `_${cluster}`;

        const contentLength = content.length;
        document.getElementById("generatedContent").innerText = content;
        document.getElementById("contentLengthIndicator").innerText = `(${contentLength} characters)`;

        const warningMessage = document.getElementById("warningMessage");
        if (contentLength > 40) {
            warningMessage.innerText = "Warning: Content exceeds 40 characters!";
        } else {
            warningMessage.innerText = "";
        }

        const taggedUrl = `${url}?utm_source=${source}&utm_medium=${medium}&utm_campaign=${campaign}&utm_content=${content}`;
        document.getElementById("generatedTaggedUrl").innerText = taggedUrl;

        document.getElementById("resultContainer").style.display = "block";

        // Menambahkan data ke tabel riwayat
        const historyTable = document.getElementById("historyTable");
        const row = historyTable.insertRow();
        row.insertCell(0).innerText = description;
        row.insertCell(1).innerText = source;
        row.insertCell(2).innerText = medium;
        row.insertCell(3).innerText = campaign;
        row.insertCell(4).innerText = content;
        row.insertCell(5).innerText = url;
        row.insertCell(6).innerText = taggedUrl;
        historyTable.style.display = "table";
    }

    function copyToClipboard(elementId) {
        const text = document.getElementById(elementId).innerText;
        navigator.clipboard.writeText(text).then(() => {
            alert("Copied to clipboard!");
        }).catch(err => {
            console.error('Failed to copy:', err);
        });
    }
</script>

</body>
</html>
